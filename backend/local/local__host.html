<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>파일 변환기</title>
    <style>
        body { font-family: sans-serif; margin: 2em; }
        #result { background-color: #f0f0f0; padding: 1em; margin-top: 1em; white-space: pre-wrap; word-wrap: break-word; }
        #error { background-color: #ffdddd; color: #d8000c; padding: 1em; margin-top: 1em; }
    </style>
</head>
<body>
    <h1>파일을 JSON으로 변환</h1>
    <p>txt, Word(.docx) 파일을 업로드하세요.</p>
    
    <form id="upload-form">
        <input type="file" id="file-input" name="file" required>
        <button type="submit">변환하기</button>
    </form>

    <h3>결과:</h3>
    <pre id="result"></pre>
    <pre id="error" style="display:none;"></pre>

    <script>
        const form = document.getElementById('upload-form');
        const fileInput = document.getElementById('file-input');
        const resultDiv = document.getElementById('result');
        const errorDiv = document.getElementById('error');

        form.addEventListener('submit', async (event) => {
            event.preventDefault(); // 폼 기본 제출 동작 방지
            
            resultDiv.textContent = '변환 중...';
            errorDiv.style.display = 'none';

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            try {
                // API 서버의 /convert-to-json/ 엔드포인트로 파일 전송
                const response = await fetch('/convert-to-json/', {
                    method: 'POST',
                    body: formData,
                });

                const data = await response.json();

                if (!response.ok) {
                    // 서버가 에러를 반환한 경우 (예: 400, 500)
                    throw new Error(data.detail || '알 수 없는 오류가 발생했습니다.');
                }
                
                // 성공 시, 받은 JSON 데이터를 예쁘게 포맷해서 표시
                resultDiv.textContent = JSON.stringify(data, null, 2);

            } catch (error) {
                resultDiv.textContent = '';
                errorDiv.textContent = '오류: ' + error.message;
                errorDiv.style.display = 'block';
            }
        });
    </script>
</body>
</html>